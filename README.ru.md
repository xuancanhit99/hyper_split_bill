# Hyper Split Bill (Разделение Счетов)

Hyper Split Bill — это приложение на Flutter, разработанное для упрощения процесса разделения общих счетов. Пользователи могут загрузить изображение счета, приложение автоматически извлечет позиции и цены с помощью OCR и ИИ, отредактирует детали, назначит позиции участникам и рассчитает индивидуальные доли.

## Возможности

*   **Аутентификация пользователя:** Безопасный вход и регистрация (вероятно, с использованием Supabase Auth).
*   **Загрузка счета:** Загрузка изображений счетов из галереи устройства или камеры.
*   **Обрезка изображения:** Обрезка загруженного изображения для фокусировки на релевантной области счета.
*   **OCR обработка:** Извлечение текстовых данных из изображения счета с помощью сервиса оптического распознавания символов (OCR).
*   **Структурирование с помощью ИИ:** Автоматическое структурирование извлеченного текста в позиции счета, цены и, возможно, идентификация участников с помощью сервиса ИИ/LLM.
*   **Редактирование счета:** Ручное добавление, редактирование или удаление позиций счета, участников и общей информации о счете (например, название, дата, валюта).
*   **Назначение участников:** Назначение конкретных позиций разным участникам, участвующим в счете.
*   **Расчет разделения:** Автоматический расчет суммы, которую должен каждый участник.
*   **История счетов:** (Предполагается) Просмотр и управление ранее обработанными счетами.
*   **Взаимодействие с чат-ботом:** (Возможно) Взаимодействие с чат-ботом для помощи или уточнения структурированных данных.

## Технологический стек

*   **Фреймворк:** Flutter
*   **Архитектура:** Clean Architecture (Data, Domain, Presentation)
*   **Управление состоянием:** Bloc / flutter_bloc
*   **Внедрение зависимостей:** get_it / injectable
*   **Маршрутизация:** go_router
*   **Бэкенд:** Supabase (Auth, Database)
*   **Внешние сервисы:**
    *   API сервиса OCR (Конкретный сервис не определен)
    *   API сервиса ИИ/LLM (Конкретный сервис не определен, возможно, для структурирования данных через интерфейс чата)
*   **Обработка изображений:** image_picker, image_cropper (или аналогичные)

## Обзор архитектуры

Приложение следует принципам Clean Architecture, разделяя задачи на три основных слоя:

1.  **Presentation (Представление):** Содержит UI (Виджеты, Страницы) и Управление состоянием (Blocs). Обрабатывает взаимодействие с пользователем и отображает данные.
2.  **Domain (Домен):** Содержит бизнес-логику (Use Cases) и основные сущности (Entities). Определяет основную функциональность приложения независимо от UI или источников данных.
3.  **Data (Данные):** Содержит реализации репозиториев (Repositories) и источники данных (Data Sources) (Удаленные - API, Supabase; Локальные - возможно, кэш). Обрабатывает получение и хранение данных.

Внедрение зависимостей управляется с помощью `get_it` и `injectable` для разделения компонентов и упрощения тестирования. Навигация обрабатывается `go_router`.

## Начало работы

**Предварительные требования:**

*   Установленный Flutter SDK (проверьте `pubspec.yaml` на предмет ограничений версии)
*   Установленный Dart SDK
*   Редактор, такой как VS Code или Android Studio
*   Аккаунт Supabase и настроенный проект
*   API ключи для используемых сервисов OCR и ИИ/LLM

**Установка и настройка:**

1.  **Клонируйте репозиторий:**
    ```bash
    git clone <repository-url>
    cd hyper_split_bill
    ```
2.  **Настройте переменные окружения:**
    *   Скопируйте файл `.env.example` в `.env`:
        ```bash
        cp .env.example .env
        ```
    *   Заполните необходимые значения в файле `.env`, включая:
        *   URL и Anon Key Supabase
        *   API ключи для сервисов OCR и ИИ

3.  **Установите зависимости:**
    ```bash
    flutter pub get
    ```
4.  **Сгенерируйте код для внедрения зависимостей:**
    ```bash
    dart run build_runner build --delete-conflicting-outputs
    ```

**Запуск приложения:**

*   **Web:**
    ```bash
    flutter run -d chrome
    ```
*   **Mobile (Android/iOS):**
    *   Убедитесь, что у вас подключено устройство или запущен эмулятор/симулятор.
    *   ```bash
        flutter run
        ```

## Структура проекта (папка `lib`)

```
lib/
├── app.dart                  # Настройка основного виджета приложения (MaterialApp, Router)
├── injection_container.dart  # Настройка внедрения зависимостей (GetIt)
├── injection_module.dart     # Модули для injectable
├── main.dart                 # Точка входа приложения
├── common/                   # Виджеты/Утилиты, общие для всех функций
├── core/                     # Основные функции (конфигурация, константы, обработка ошибок, маршрутизация, тема)
│   ├── config/
│   ├── constants/
│   ├── error/
│   ├── router/
│   └── theme/
└── features/                 # Модули функций (согласно Clean Architecture)
    ├── auth/                 # Функция аутентификации
    │   ├── data/
    │   ├── domain/
    │   └── presentation/
    └── bill_splitting/       # Функция разделения счетов
        ├── data/             # Источники данных, модели, реализация репозитория
        ├── domain/           # Сущности, сценарии использования, интерфейс репозитория
        └── presentation/     # Blocs, страницы, виджеты